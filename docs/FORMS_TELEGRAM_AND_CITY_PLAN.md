# –ü–ª–∞–Ω: —Ñ–æ—Ä–º—ã –≤ Telegram, –æ—Ç–∑—ã–≤—ã —Å –º–æ–¥–µ—Ä–∞—Ü–∏–µ–π, –≤—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞

## 1. Telegram-–±–æ—Ç (–∑–∞—è–≤–∫–∏ —Å —Å–∞–π—Ç–∞)

- **–¢–æ–∫–µ–Ω:** —Ç–æ–ª—å–∫–æ –≤ `.env`: `TELEGRAM_BOT_TOKEN`. –í git –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å.
- **–ö—É–¥–∞ —Å–ª–∞—Ç—å –∑–∞—è–≤–∫–∏:** `TELEGRAM_CHAT_ID` –≤ `.env` (ID —á–∞—Ç–∞/–≥—Ä—É–ø–ø—ã, –∫—É–¥–∞ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞—è–≤–∫–∏).
- **Webhook:** –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç –¥–ª—è –±–æ—Ç–∞ –∏–∑ env: `POST /api/telegram/forms-webhook` (–±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ Bot –≤ –ë–î).
- **–û—Ç–≤–µ—Ç Telegram:** –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ webhook –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `200` –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å `message` –∏ `callback_query`.
- **–ö–æ–º–∞–Ω–¥–∞ /start:** –æ—Ç–≤–µ—Ç: ¬´üëã –ü—Ä–∏–≤–µ—Ç, USERNAME! –Ø –±–æ—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞—è–≤–æ–∫ —Å —Å–∞–π—Ç–∞ proffi-center.ru. –í—Å–µ –∑–∞—è–≤–∫–∏ —Å —Ñ–æ—Ä–º –±—É–¥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —Å—é–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.¬ª

## 2. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤—Å–µ—Ö —Ñ–æ—Ä–º –≤ –±–æ—Ç–∞

- –ï–¥–∏–Ω—ã–π –ø—É–±–ª–∏—á–Ω—ã–π endpoint: `POST /api/v1/forms/lead`.
- –¢–µ–ª–æ: `type` (callback | low_price | form_5min | rassrochka | review), `name?`, `phone`, `city_slug?`, `message?`, –∏ —Ç.–¥. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å/–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å **–≥–æ—Ä–æ–¥** (—Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å) –∏ –≤–∫–ª—é—á–∞—Ç—å –≤ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram.
- –í –∫–∞–∂–¥–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ –≤ Telegram —É–∫–∞–∑—ã–≤–∞—Ç—å: —Ç–∏–ø —Ñ–æ—Ä–º—ã, –≥–æ—Ä–æ–¥/—Ä–µ–≥–∏–æ–Ω, –¥–∞–Ω–Ω—ã–µ (–∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω, —Ç–µ–∫—Å—Ç).
- –§–æ—Ä–º—ã –Ω–∞ —Å–∞–π—Ç–µ: –ø–æ–ø–∞–ø ¬´–í–∞–º –ø–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç—å?¬ª, ¬´–ó–∞–∫–∞–∑–∞—Ç—å –ø–æ –Ω–∏–∑–∫–æ–π —Ü–µ–Ω–µ¬ª, ¬´–†–∞—Å—Å—á–∏—Ç–∞–µ–º –∑–∞ 5 –º–∏–Ω—É—Ç¬ª, —Ä–∞—Å—Å—Ä–æ—á–∫–∞, —Ñ–æ—Ä–º–∞ –æ—Ç–∑—ã–≤–∞ ‚Äî –≤—Å–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —á–µ—Ä–µ–∑ —ç—Ç–æ—Ç endpoint –∏ –∑–∞—Ç–µ–º –≤ –±–æ—Ç–∞.

## 3. –û—Ç–∑—ã–≤—ã: –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –º–æ–¥–µ—Ä–∞—Ü–∏—è –≤ –±–æ—Ç–µ

- –ü—É–±–ª–∏—á–Ω—ã–π `POST /api/v1/reviews` (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏): —Å–æ–∑–¥–∞—ë—Ç –æ—Ç–∑—ã–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending` (–∏–ª–∏ `draft` –¥–æ –º–æ–¥–µ—Ä–∞—Ü–∏–∏).
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –±—ç–∫–µ–Ω–¥–µ: –∏–º—è, —Ç–µ–∫—Å—Ç, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Ç–µ–ª–µ—Ñ–æ–Ω.
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–∑—ã–≤–∞ ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram —Å –∫–Ω–æ–ø–∫–∞–º–∏ ¬´–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å¬ª / ¬´–û—Ç–∫–∞–∑–∞—Ç—å¬ª (inline), –≤ callback_data ‚Äî id –æ—Ç–∑—ã–≤–∞ –∏ –¥–µ–π—Å—Ç–≤–∏–µ.
- –û–±—Ä–∞–±–æ—Ç–∫–∞ `callback_query` –≤ forms-webhook:
  - –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å `published`, `published_at = now()`, –æ—Ç–≤–µ—Ç–∏—Ç—å –≤ Telegram, —É–±—Ä–∞—Ç—å –∫–Ω–æ–ø–∫–∏.
  - –û—Ç–∫–∞–∑–∞—Ç—å: —É–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤, –æ—Ç–≤–µ—Ç–∏—Ç—å –≤ Telegram, —É–±—Ä–∞—Ç—å –∫–Ω–æ–ø–∫–∏.
- –ù–∞ —Å–∞–π—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ—Ç–∑—ã–≤—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `published` (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ Public API).

## 4. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ –Ω–∞ —Å–∞–π—Ç

- –ì–æ—Ä–æ–¥–∞: –ê–Ω–∞–ø–∞, –°—Ç–∞–≤—Ä–æ–ø–æ–ª—å, –ú–æ—Å–∫–≤–∞ (–∫–∞–∫ —Å–µ–π—á–∞—Å).
- –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞—Ö–æ–¥–µ (–∏–ª–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –≤—ã–±–æ—Ä–∞): –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –≥–æ—Ä–æ–¥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî –ê–Ω–∞–ø–∞) –∏ –ø—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ —Å –ø–æ–¥–¥–æ–º–µ–Ω–æ–º –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å **–ø–æ–ø–∞–ø –≤—ã–±–æ—Ä–∞ –≥–æ—Ä–æ–¥–∞**.
- –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞: —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ `localStorage`, –ø–æ–¥–∫–ª—é—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞ (—Ç–µ–ª–µ—Ñ–æ–Ω—ã, –∞–¥—Ä–µ—Å–∞, —Ä–∞–π–æ–Ω) –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏—Ö –Ω–∞ —Å–∞–π—Ç–µ.
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: –≥–æ—Ä–æ–¥ –ê–Ω–∞–ø–∞, –¥–∞–Ω–Ω—ã–µ –ê–Ω–∞–ø—ã.

## 5. Newblock: –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –≤—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞ –±–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞

- –£–º–µ–Ω—å—à–∏—Ç—å/–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –±–ª–æ–∫–∞ newblock (—Ä–∞–∑–º–µ—Ä/—Å—Ç–∏–ª–∏).
- –ù–∞ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–∞–π—Ç–µ `https://proffi-center.ru/`: –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –≥–æ—Ä–æ–¥–∞ –≤ newblock **–Ω–µ –¥–µ–ª–∞—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç** –Ω–∞ –ø–æ–¥–¥–æ–º–µ–Ω ‚Äî —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞ (localStorage + –∫–æ–Ω—Ç–µ–∫—Å—Ç) –∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞ –Ω–∞ —Ç–æ–º –∂–µ –¥–æ–º–µ–Ω–µ.

## 6. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è (—á–µ–∫–ª–∏—Å—Ç)

- [ ] `.env`: `TELEGRAM_BOT_TOKEN`, `TELEGRAM_CHAT_ID` (–≤ .env.example —Ç–æ–ª—å–∫–æ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã, –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π).
- [ ] Config: `config/telegram.php` ‚Äî `forms_chat_id`, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π webhook URL –¥–ª—è —Ñ–æ—Ä–º-–±–æ—Ç–∞.
- [ ] `TelegramService`: –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å `reply_markup` (inline_keyboard), `answerCallbackQuery`, `editMessageReplyMarkup`.
- [ ] –†–æ—É—Ç `POST /api/telegram/forms-webhook`: –æ–±—Ä–∞–±–æ—Ç–∫–∞ update (message /start, callback_query approve/reject –æ—Ç–∑—ã–≤–∞).
- [ ] –†–æ—É—Ç `POST /api/v1/forms/lead`: –ø—Ä–∏—ë–º –∑–∞—è–≤–∫–∏, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (host –∏–ª–∏ city_slug), –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram.
- [ ] –†–æ—É—Ç `POST /api/v1/reviews` (public): —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞ `pending`, –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram —Å –∫–Ω–æ–ø–∫–∞–º–∏.
- [ ] –ú–∏–≥—Ä–∞—Ü–∏—è/–º–æ–¥–µ–ª—å Review: —Å—Ç–∞—Ç—É—Å `pending` (–µ—Å–ª–∏ –µ—â—ë –Ω–µ—Ç).
- [ ] Frontend: API `submitLead`, `submitReview`; –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ –≤—Å–µ–º —Ñ–æ—Ä–º–∞–º (callback, low_price, 5min, rassrochka, –æ—Ç–∑—ã–≤).
- [ ] Frontend: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞, –ø–æ–ø–∞–ø –≤—ã–±–æ—Ä–∞, `GET /api/v1/site/by-city/{slug}`, –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –≥–æ—Ä–æ–¥–æ–º –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º –¥–æ–º–µ–Ω–µ.
- [ ] Frontend: newblock ‚Äî –∫–ª–∏–∫ –ø–æ –≥–æ—Ä–æ–¥—É –±–µ–∑ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–æ—Ä–æ–¥–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ; –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è CSS newblock.
- [x] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è webhook: `php artisan telegram:register-forms-webhook` (–ø—Ä–æ–≤–µ—Ä–∫–∞: –æ—Ç–≤–µ—Ç Telegram 200 –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ /start –±–æ—Ç—É).

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

**–ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—å –≤ git —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.** –í `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∑–∞–¥–∞—Ç—å:

- `TELEGRAM_BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –¥–ª—è –∑–∞—è–≤–æ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä 8281526294:AAG...).
- `TELEGRAM_CHAT_ID` ‚Äî ID —á–∞—Ç–∞ –∏–ª–∏ –≥—Ä—É–ø–ø—ã, –∫—É–¥–∞ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞—è–≤–∫–∏ (—É–∑–Ω–∞—Ç—å: –Ω–∞–ø–∏—Å–∞—Ç—å –±–æ—Ç—É /start, –∑–∞—Ç–µ–º –ø–æ–ª—É—á–∏—Ç—å chat_id —á–µ—Ä–µ–∑ getUpdates –∏–ª–∏ –±–æ—Ç @userinfobot).
- –ü–æ –∂–µ–ª–∞–Ω–∏—é: `TELEGRAM_WEBHOOK_SECRET` ‚Äî —Å–µ–∫—Ä–µ—Ç –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ `X-Telegram-Bot-Api-Secret-Token` (–±–µ–∑ –Ω–µ–≥–æ webhook –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç Telegram).
